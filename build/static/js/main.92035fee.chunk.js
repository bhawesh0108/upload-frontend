(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{17:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var c=n(11),o=n.n(c),a=(n(17),n(3)),i=n(2),s=n(4),l=n(1),r=n(0),d=function(){var e=Object(i.f)(),t=Object(l.useContext)(w),n=t.state,c=t.dispatch;return Object(r.jsx)("nav",{children:Object(r.jsxs)("div",{className:"nav-wrapper white",children:[Object(r.jsx)(s.b,{to:n?"/":"/signin",className:"brand-logo left",children:"Upload"}),Object(r.jsx)("ul",{id:"nav-mobile",className:"right",children:n?[Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/profile",children:"Profile"})}),Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/create",children:"Create Post"})}),Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/myfollowingpost",children:"My Following Posts"})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{class:"btn #e53935 red darken-1",onClick:function(t){localStorage.clear(),c({type:"CLEAR"}),e("/signin")},children:"Sign Out"})})]:[Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/Signin",children:"Sign IN"})}),Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/Signup",children:"Sign UP"})})]})]})})},j=(n(19),function(){var e=Object(l.useState)([]),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(l.useContext)(w),i=o.state;o.dispatch;Object(l.useEffect)((function(){fetch("/allPosts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e),c(e.posts)}))}),[]);return Object(r.jsx)("div",{className:"home",children:n?n.map((function(e){return Object(r.jsxs)("div",{className:"card home-card",children:[Object(r.jsxs)("h5",{style:{padding:"5px"},children:[Object(r.jsx)(s.b,{to:e.postedBy._id!==i._id?"/profile/"+e.postedBy._id:"/profile",children:e.postedBy.name})," ",e.postedBy._id==i._id&&Object(r.jsx)("i",{className:"material-icons",style:{float:"right"},onClick:function(){return t=e._id,void fetch("/deletepost/".concat(t),{method:"delete",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=n.filter((function(t){return t._id!==e._id}));c(t)}));var t},children:"delete"})]}),Object(r.jsx)("div",{className:"card-image",children:Object(r.jsx)("img",{src:e.photo,alt:""})}),Object(r.jsxs)("div",{className:"card-content",children:[Object(r.jsx)("i",{className:"material-icons",style:{color:"red"},children:"favorite"}),e.likes.includes(i._id)?Object(r.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/unlike",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:t})}).then((function(e){return e.json()})).then((function(e){var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:"thumb_down"}):Object(r.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/like",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:t})}).then((function(e){return e.json()})).then((function(e){var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:"thumb_up"}),Object(r.jsxs)("h6",{children:[e.likes.length," likes"]}),Object(r.jsx)("h6",{children:e.title}),Object(r.jsx)("p",{children:e.body}),e.comments.map((function(e){return Object(r.jsxs)("h6",{children:[Object(r.jsx)("span",{style:{fontWeight:"800"},children:e.postedBy.name})," ",e.text]},e._id)})),Object(r.jsx)("form",{onSubmit:function(t){var o,a;t.preventDefault(),o=t.target[0].value,a=e._id,fetch("/comment",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:a,text:o})}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:Object(r.jsx)("input",{type:"text",placeholder:"add a comment"})})]})]},e._id)})):null})}),u=n(5),h=function(){var e=Object(l.useState)([]),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(l.useContext)(w),i=o.state,s=o.dispatch,d=Object(l.useState)(""),j=Object(a.a)(d,2),h=j[0],p=j[1],b=Object(l.useState)(""),f=Object(a.a)(b,2),O=f[0],g=f[1];Object(l.useEffect)((function(){fetch("/mypost",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){c(e.mypost)}))}),[]),Object(l.useEffect)((function(){if(h){console.log("Upload Pic"),console.log(O);var e=new FormData;e.append("file",h),e.append("upload_preset","upload"),e.append("cloud_name","ddlgib7yw"),fetch("https://api.cloudinary.com/v1_1/ddlgib7yw/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){g(e.url),fetch("/updatepic",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({pic:e.url})}).then((function(e){return e.json()})).then((function(e){console.log(e),localStorage.setItem("user",JSON.stringify(Object(u.a)(Object(u.a)({},i),{},{pic:e.pic}))),s({type:"UPDATEPIC",payload:e.pic}),window.location.reload()}))})).catch((function(e){console.log(e)}))}}),[h]);return Object(r.jsxs)("div",{style:{maxWidth:"550px",margin:"0px auto"},children:[Object(r.jsxs)("div",{style:{margin:"18px 0px",borderBottom:"1px solid grey"},children:[Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[Object(r.jsx)("div",{children:Object(r.jsx)("img",{style:{width:"200px",height:"200px",borderRadius:"100px"},src:i?i.pic:"loading"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h5",{children:i?i.name:"loading"}),Object(r.jsx)("h5",{children:i?i.email:"loading"}),Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"108%"},children:[Object(r.jsxs)("h6",{children:[n?n.length:"0"," posts"]}),Object(r.jsxs)("h6",{children:[i?i.followers.length:"0"," followers"]}),Object(r.jsxs)("h6",{children:[i?i.following.length:"0"," following"]})]})]}),Object(r.jsx)("div",{})]}),Object(r.jsx)("div",{style:{position:"relative",margin:"8px 50px"},children:Object(r.jsxs)("div",{className:"file-field input-field",style:{margin:"10px"},children:[Object(r.jsxs)("div",{className:"btn",children:[Object(r.jsx)("span",{children:"Update Pic"}),Object(r.jsx)("input",{type:"file",onChange:function(e){var t;t=e.target.files[0],p(t)}})]}),Object(r.jsx)("div",{className:"file-path-wrapper",children:Object(r.jsx)("input",{className:"file-path validate",type:"text"})})]})})]}),Object(r.jsx)("div",{className:"gallery",children:n?n.map((function(e){return Object(r.jsx)("img",{className:"item",src:e.photo,alt:e.title},e._id)})):null})]})},p=n(7),b=n.n(p),f=function(){var e=Object(i.f)(),t=Object(l.useState)(""),n=Object(a.a)(t,2),c=n[0],o=n[1],d=Object(l.useState)(""),j=Object(a.a)(d,2),u=j[0],h=j[1],p=Object(l.useState)(""),f=Object(a.a)(p,2),O=f[0],g=f[1],m=Object(l.useState)(""),x=Object(a.a)(m,2),y=x[0],v=x[1],w=Object(l.useState)(void 0),S=Object(a.a)(w,2),N=S[0],_=S[1];Object(l.useEffect)((function(){N&&C()}),[N]);var C=function(){/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(u)?(console.log("Upload Field"),console.log(N),fetch("/signup",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c,password:O,email:u,pic:N})}).then((function(e){return e.json()})).then((function(t){t.error?b.a.toast({html:t.error,classes:"#c62828 red darken-3"}):(b.a.toast({html:t.message,classes:"#43a047 green darken-1"}),e.push("/signin"))})).catch((function(e){console.log(e)}))):b.a.toast({html:"invalid email",classes:"#c62828 red darken-3"})};return Object(r.jsx)("div",{className:"mycard",children:Object(r.jsxs)("div",{className:"card auth-card",children:[Object(r.jsx)("h2",{children:"Upload"}),Object(r.jsx)("input",{type:"text",placeholder:"name",value:c,onChange:function(e){o(e.target.value)}}),Object(r.jsx)("input",{type:"text",placeholder:"email",value:u,onChange:function(e){h(e.target.value)}}),Object(r.jsx)("input",{type:"password",placeholder:"password",value:O,onChange:function(e){g(e.target.value)}}),Object(r.jsxs)("div",{className:"file-field input-field",children:[Object(r.jsxs)("div",{className:"btn",children:[Object(r.jsx)("span",{children:"Upload Image"}),Object(r.jsx)("input",{type:"file",onChange:function(e){v(e.target.files[0])}})]}),Object(r.jsx)("div",{className:"file-path-wrapper",children:Object(r.jsx)("input",{className:"file-path validate",type:"text"})})]}),Object(r.jsx)("button",{class:"btn waves-effect waves-light",onClick:function(){y?(console.log("Image"),console.log(y),function(){console.log("Upload Pic"),console.log(N);var e=new FormData;e.append("file",y),e.append("upload_preset","upload"),e.append("cloud_name","ddlgib7yw"),fetch("https://api.cloudinary.com/v1_1/ddlgib7yw/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){console.log("URL Uploaded"),console.log(e.url),_(e.url)})).catch((function(e){console.log(e)}))}()):C()},children:"Sign Up"}),Object(r.jsx)("h5",{children:Object(r.jsx)(s.b,{to:"/Signin",children:"Already have an account ?"})})]})})},O=function(){var e=Object(l.useContext)(w),t=(e.state,e.dispatch),n=Object(i.f)(),c=Object(l.useState)(""),o=Object(a.a)(c,2),d=o[0],j=o[1],u=Object(l.useState)(""),h=Object(a.a)(u,2),p=h[0],f=h[1];return Object(r.jsx)("div",{className:"mycard",children:Object(r.jsxs)("div",{className:"card auth-card",children:[Object(r.jsx)("h2",{children:"Upload"}),Object(r.jsx)("input",{type:"text",placeholder:"email",value:d,onChange:function(e){j(e.target.value)}}),Object(r.jsx)("input",{type:"password",placeholder:"password",value:p,onChange:function(e){f(e.target.value)}}),Object(r.jsx)("button",{class:"btn waves-effect waves-light",onClick:function(){/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(d)?fetch("/signin",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:p,email:d})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.error?b.a.toast({html:e.error,classes:"#c62828 red darken-3"}):(localStorage.setItem("jwt",e.token),localStorage.setItem("user",JSON.stringify(e.user)),t({type:"USER",payload:e.user}),b.a.toast({html:"signedin success",classes:"#43a047 green darken-1"}),n("/"))})).catch((function(e){console.log(e)})):b.a.toast({html:"invalid email",classes:"#c62828 red darken-3"})},children:"Sign In"}),Object(r.jsx)("h5",{children:Object(r.jsx)(s.b,{to:"/Signup",children:"Don't have an account ?"})})]})})},g=function(){var e=Object(i.f)(),t=Object(l.useState)(""),n=Object(a.a)(t,2),c=n[0],o=n[1],s=Object(l.useState)(""),d=Object(a.a)(s,2),j=d[0],u=d[1],h=Object(l.useState)(""),p=Object(a.a)(h,2),f=p[0],O=p[1],g=Object(l.useState)(""),m=Object(a.a)(g,2),x=m[0],y=m[1];Object(l.useEffect)((function(){x&&fetch("/createPost",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({title:c,body:j,pic:x})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.error?b.a.toast({html:t.error,classes:"#c62828 red darken-3"}):(b.a.toast({html:"Posted Successfully",classes:"#43a047 green darken-1"}),e("/"))})).catch((function(e){console.log(e)}))}),[x]);return Object(r.jsxs)("div",{className:"card input-filed",style:{margin:"40px auto",padding:"20px",textAlign:"center",maxWidth:"550px"},children:[Object(r.jsx)("input",{type:"text",placeholder:"title",value:c,onChange:function(e){o(e.target.value)}}),Object(r.jsx)("input",{type:"text",placeholder:"body",value:j,onChange:function(e){u(e.target.value)}}),Object(r.jsxs)("div",{className:"file-field input-field",children:[Object(r.jsxs)("div",{className:"btn",children:[Object(r.jsx)("span",{children:"Upload Image"}),Object(r.jsx)("input",{type:"file",onChange:function(e){O(e.target.files[0])}})]}),Object(r.jsx)("div",{className:"file-path-wrapper",children:Object(r.jsx)("input",{className:"file-path validate",type:"text"})})]}),Object(r.jsx)("button",{class:"btn waves-effect waves-light",onClick:function(){var e=new FormData;e.append("file",f),e.append("upload_preset","upload"),e.append("cloud_name","ddlgib7yw"),fetch("https://api.cloudinary.com/v1_1/ddlgib7yw/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){y(e.url)})).catch((function(e){console.log(e)}))},children:"Submit Post"})]})},m=n(12),x=function(){var e=Object(l.useState)(null),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(l.useContext)(w),s=o.state,d=o.dispatch,j=Object(i.g)().userid,h=Object(l.useState)(!s||!s.following.includes(j)),p=Object(a.a)(h,2),b=p[0],f=p[1];console.log(j),Object(l.useEffect)((function(){fetch("/user/".concat(j),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e),c(e)}))}),[]);return Object(r.jsxs)("div",{style:{maxWidth:"650px",margin:"0px auto"},children:[Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",margin:"120px 0px",borderBottom:"1px solid grey"},children:[Object(r.jsxs)("div",{children:[console.log(n),n?Object(r.jsx)("img",{style:{width:"160px",height:"160px",borderRadius:"80px"},src:n.user.pic}):null]}),n?Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{children:n.user.name}),Object(r.jsx)("h5",{children:n.user.email}),Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"108%"},children:[Object(r.jsxs)("h6",{children:[n.posts.length," posts"]}),Object(r.jsxs)("h6",{children:[n.user.followers.length," followers"]}),Object(r.jsxs)("h6",{children:[n.user.following.length," following"]})]}),b?Object(r.jsx)("button",{style:{margin:"10px"},className:"btn waves-effect waves-light #64b5f6 blue darken-1",onClick:function(){fetch("/follow",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({followId:j})}).then((function(e){return e.json()})).then((function(e){console.log(e),d({type:"UPDATE",payload:{following:e.following,followers:e.followers}}),localStorage.setItem("user",JSON.stringify(e)),c((function(t){return Object(u.a)(Object(u.a)({},t),{},{user:Object(u.a)(Object(u.a)({},t.user),{},{followers:[].concat(Object(m.a)(t.user.followers),[e._id])})})})),f(!1)}))},children:"Follow"}):Object(r.jsx)("button",{style:{margin:"10px"},className:"btn waves-effect waves-light #64b5f6 blue darken-1",onClick:function(){fetch("/unfollow",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({unfollowId:j})}).then((function(e){return e.json()})).then((function(e){d({type:"UPDATE",payload:{following:e.following,followers:e.followers}}),localStorage.setItem("user",JSON.stringify(e)),c((function(t){var n=t.user.followers.filter((function(t){return t!=e._id}));return Object(u.a)(Object(u.a)({},t),{},{user:Object(u.a)(Object(u.a)({},t.user),{},{followers:n})})})),f(!0)}))},children:"UnFollow"})]}):null]}),console.log(n),Object(r.jsx)("div",{className:"gallery",children:n?n.posts.map((function(e){return Object(r.jsx)("img",{className:"item",src:e.photo,alt:e.title},e._id)})):null})]})},y=function(){var e=Object(l.useState)([]),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(l.useContext)(w),i=o.state;o.dispatch;Object(l.useEffect)((function(){fetch("/getsubpost",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e),c(e.posts)}))}),[]);return Object(r.jsx)("div",{className:"home",children:n.map((function(e){return Object(r.jsxs)("div",{className:"card home-card",children:[Object(r.jsxs)("h5",{style:{padding:"5px"},children:[Object(r.jsx)(s.b,{to:e.postedBy._id!==i._id?"/profile/"+e.postedBy._id:"/profile",children:e.postedBy.name})," ",e.postedBy._id==i._id&&Object(r.jsx)("i",{className:"material-icons",style:{float:"right"},onClick:function(){return t=e._id,void fetch("/deletepost/".concat(t),{method:"delete",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=n.filter((function(t){return t._id!==e._id}));c(t)}));var t},children:"delete"})]}),Object(r.jsx)("div",{className:"card-image",children:Object(r.jsx)("img",{src:e.photo})}),Object(r.jsxs)("div",{className:"card-content",children:[Object(r.jsx)("i",{className:"material-icons",style:{color:"red"},children:"favorite"}),e.likes.includes(i._id)?Object(r.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/unlike",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:t})}).then((function(e){return e.json()})).then((function(e){var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:"thumb_down"}):Object(r.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/like",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:t})}).then((function(e){return e.json()})).then((function(e){var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:"thumb_up"}),Object(r.jsxs)("h6",{children:[e.likes.length," likes"]}),Object(r.jsx)("h6",{children:e.title}),Object(r.jsx)("p",{children:e.body}),e.comments.map((function(e){return Object(r.jsxs)("h6",{children:[Object(r.jsx)("span",{style:{fontWeight:"500"},children:e.postedBy.name})," ",e.text]},e._id)})),Object(r.jsx)("form",{onSubmit:function(t){var o,a;t.preventDefault(),o=t.target[0].value,a=e._id,fetch("/comment",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postId:a,text:o})}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=n.map((function(t){return t._id==e._id?e:t}));c(t)})).catch((function(e){console.log(e)}))},children:Object(r.jsx)("input",{type:"text",placeholder:"add a comment"})})]})]},e._id)}))})},v=function(e,t){return"USER"==t.type?t.payload:"CLEAR"==t.type?null:"UPDATE"==t.type?Object(u.a)(Object(u.a)({},e),{},{followers:t.payload.followers,following:t.payload.following}):"UPDATEPIC"==t.type?Object(u.a)(Object(u.a)({},e),{},{pic:t.payload}):e},w=Object(l.createContext)(),S=function(){Object(i.f)();var e=Object(l.useContext)(w),t=(e.state,e.dispatch);return Object(l.useEffect)((function(){var e=JSON.parse(localStorage.getItem("user"));e&&t({type:"USER",payload:e})}),[]),Object(r.jsxs)(i.c,{children:[Object(r.jsx)(i.a,{exact:!0,path:"/",element:Object(r.jsx)(j,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/profile",element:Object(r.jsx)(h,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/signup",element:Object(r.jsx)(f,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/signin",element:Object(r.jsx)(O,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/create",element:Object(r.jsx)(g,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/profile/:userid",element:Object(r.jsx)(x,{})}),Object(r.jsx)(i.a,{exact:!0,path:"/myfollowingpost",element:Object(r.jsx)(y,{})})]})};var N=function(){var e=Object(l.useReducer)(v,null),t=Object(a.a)(e,2),n=t[0],c=t[1];return Object(r.jsx)(w.Provider,{value:{state:n,dispatch:c},children:Object(r.jsxs)(s.a,{children:[Object(r.jsx)(d,{}),Object(r.jsx)(S,{})]})})};o.a.render(Object(r.jsx)(N,{}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.92035fee.chunk.js.map