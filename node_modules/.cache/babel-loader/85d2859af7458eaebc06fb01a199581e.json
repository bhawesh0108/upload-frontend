{"ast":null,"code":"import _slicedToArray from\"/Users/bhawesh/Desktop/01-starting-setup/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import react,{useState,useEffect,useContext}from\"react\";import{UserContext}from'../../App';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;useEffect(function(){fetch('/allPosts',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem('jwt')}}).then(function(res){return res.json();}).then(function(result){console.log(result);setData(result.posts);});},[]);var likePost=function likePost(id){fetch('/like',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){//    console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var unlikePost=function unlikePost(id){fetch('/unlike',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){// console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var makeComment=function makeComment(text,postId){fetch('/comment',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:postId,text:text})}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var deletePost=function deletePost(postid){fetch(\"/deletepost/\".concat(postid),{method:\"delete\",headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.filter(function(item){return item._id!==result._id;});setData(newData);});};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:data?data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"card home-card\",children:[/*#__PURE__*/_jsxs(\"h5\",{style:{padding:\"5px\"},children:[/*#__PURE__*/_jsx(Link,{to:item.postedBy._id!==state._id?\"/profile/\"+item.postedBy._id:\"/profile\",children:item.postedBy.name}),\" \",item.postedBy._id==state._id&&/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{float:\"right\"},onClick:function onClick(){return deletePost(item._id);},children:\"delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"img\",{src:item.photo,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{color:\"red\"},children:\"favorite\"}),item.likes.includes(state._id)?/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:function onClick(){unlikePost(item._id);},children:\"thumb_down\"}):/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:function onClick(){likePost(item._id);},children:\"thumb_up\"}),/*#__PURE__*/_jsxs(\"h6\",{children:[item.likes.length,\" likes\"]}),/*#__PURE__*/_jsx(\"h6\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:item.body}),item.comments.map(function(record){return/*#__PURE__*/_jsxs(\"h6\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"800\"},children:record.postedBy.name}),\" \",record.text]},record._id);}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();makeComment(e.target[0].value,item._id);},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add a comment\"})})]})]},item._id);}):null});};export default Home;","map":{"version":3,"sources":["/Users/bhawesh/Desktop/01-starting-setup/src/components/screens/Home.js"],"names":["react","useState","useEffect","useContext","UserContext","Link","Home","data","setData","state","dispatch","fetch","headers","localStorage","getItem","then","res","json","result","console","log","posts","likePost","id","method","body","JSON","stringify","postId","newData","map","item","_id","catch","err","unlikePost","makeComment","text","deletePost","postid","Authorization","filter","padding","postedBy","name","float","photo","color","likes","includes","length","title","comments","record","fontWeight","e","preventDefault","target","value"],"mappings":"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","sourcesContent":["import react,{useState,useEffect,useContext} from \"react\"\nimport {UserContext} from '../../App'\nimport {Link} from 'react-router-dom'\n\nconst Home = () => {\n    const [data,setData] = useState([]);\n    const {state,dispatch} = useContext(UserContext)\n    useEffect(()=>{\n        fetch('/allPosts',{\n            headers:{\n                \"Authorization\":\"Bearer \"+localStorage.getItem('jwt')\n            }\n        }).then(res=>res.json())\n        .then(result=>{\n            console.log(result)\n            setData(result.posts)\n        })\n    },[])\n\n    const likePost = (id)=>{\n        fetch('/like',{\n            method:\"put\",\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n            },\n            body:JSON.stringify({\n                postId:id\n            })\n        }).then(res=>res.json())\n        .then(result=>{\n                //    console.log(result)\n          const newData = data.map(item=>{\n              if(item._id==result._id){\n                  return result\n              }else{\n                  return item\n              }\n          })\n          setData(newData)\n        }).catch(err=>{\n            console.log(err)\n        })\n  }\n  const unlikePost = (id)=>{\n        fetch('/unlike',{\n            method:\"put\",\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n            },\n            body:JSON.stringify({\n                postId:id\n            })\n        }).then(res=>res.json())\n        .then(result=>{\n            // console.log(result)\n          const newData = data.map(item=>{\n              if(item._id==result._id){\n                  return result\n              }else{\n                  return item\n              }\n          })\n          setData(newData)\n        }).catch(err=>{\n          console.log(err)\n      })\n  }\n\n  const makeComment = (text,postId)=>{\n    fetch('/comment',{\n        method:\"put\",\n        headers:{\n            \"Content-Type\":\"application/json\",\n            \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n        },\n        body:JSON.stringify({\n            postId,\n            text\n        })\n    }).then(res=>res.json())\n    .then(result=>{\n        console.log(result)\n        const newData = data.map(item=>{\n          if(item._id==result._id){\n              return result\n          }else{\n              return item\n          }\n       })\n      setData(newData)\n    }).catch(err=>{\n        console.log(err)\n    })\n}\n\n    const deletePost = (postid)=>{\n        fetch(`/deletepost/${postid}`,{\n            method:\"delete\",\n            headers:{\n                Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")\n            }\n        }).then(res=>res.json())\n        .then(result=>{\n            console.log(result)\n            const newData = data.filter(item=>{\n                return item._id !== result._id\n            })\n            setData(newData)\n        })\n    }\n    return(\n     <div className = \"home\">\n         {\n             data?data.map(item=>{\n                 return(\n                    <div className=\"card home-card\" key={item._id}>\n                    {/* <h5>{item.postedBy.name} {item.postedBy._id == state._id  */}\n                    <h5 style={{padding:\"5px\"}}><Link to={item.postedBy._id !== state._id?\"/profile/\"+item.postedBy._id :\"/profile\"  }>{item.postedBy.name}</Link> {item.postedBy._id == state._id \n                            \n                        && <i className=\"material-icons\" style={{\n                            float:\"right\"\n                        }} \n                        onClick={()=>deletePost(item._id)}\n                        >delete</i>\n\n                        }\n                    </h5>\n                    <div className=\"card-image\">\n                        <img src={item.photo} alt=\"\" />\n                    </div>\n                    <div className=\"card-content\">\n                        <i className=\"material-icons\" style={{color : \"red\"}}>favorite</i>\n                        {item.likes.includes(state._id)\n                            ? \n                             <i className=\"material-icons\"\n                                    onClick={()=>{unlikePost(item._id)}}\n                              >thumb_down</i>\n                            : \n                            <i className=\"material-icons\"\n                            onClick={()=>{likePost(item._id)}}\n                            >thumb_up</i>\n                        }\n                        <h6>{item.likes.length} likes</h6>\n                        <h6>{item.title}</h6>\n                        <p>{item.body}</p>\n                        \n                        \n                        \n                        {\n                            item.comments.map(record=>{\n                                return(\n                                <h6 key={record._id}><span style={{fontWeight:\"800\"}}>{record.postedBy.name}</span> {record.text}</h6>\n                                )\n                            })\n                        }\n                        <form onSubmit={(e)=>{\n                            e.preventDefault()\n                            makeComment(e.target[0].value,item._id)\n                        }}>\n                            <input type=\"text\" placeholder=\"add a comment\" />  \n                        </form>\n                    </div>\n                 </div>\n                 )\n             }):null\n         }\n     \n    \n     </div>\n      \n     )\n }\n\n export default Home"]},"metadata":{},"sourceType":"module"}